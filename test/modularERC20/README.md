These tests mostly borrowed from TrueUSD.